# Linux - проброс payload'а без root прав

В этом разделе описано, как добавить правило `udev`, чтобы отправлять payload на вашу консоль без необходимости использования `sudo`.

Следующие инструкции работают только на системах, которые поддерживают `udev`. Большинство современных дистрибутивов поставляются с уже установленным `systemd`, который включает в себя реализацию `udev`.

Выполните эти инструкции, когда ваша консоль **не** подключена к вашему компьютеру.

!!! note "Для пользователей Arch Linux:"
    Пакет `android-udev` включает правила, которые также позволяют отправлять payload без root прав. Учтите, что это также позволяет использовать специфические Android команды, такие как `adb` и `fastboot`, без root (что и является его основной целью).


&nbsp;

### **Вариант 1: Ручное добавление правил и группы**

Следующие инструкции не предназначены для новичков. Выполняйте их только если понимаете, что делаете.

#### **Создание новой группы**

Для начала создадим новую группу и добавим себя в неё. Группа, которой будет принадлежать устройство Nintendo Switch в Linux, будет настроена на эту группу.

1. Откройте терминал.
2. Введите следующую команду: `sudo groupadd nintendo_switch`.
3. Введите пароль, если потребуется.
4. Введите следующую команду: `sudo usermod -a -G nintendo_switch $USER`. Убедитесь, что буква `G` заглавная!
5. Закройте терминал.

#### **Добавление правила udev**

Далее добавим новое правило `udev`. `udev` — это менеджер устройств ядра Linux. Указанное нами правило задаёт, что если Switch подключён в режиме `RCM`, группа, к которой принадлежит Switch, будет той, которую мы создали в предыдущем разделе.

1. Откройте терминал.
2. Переключитесь на root-пользователя с помощью команды: `sudo -i`. Введите пароль, если будет предложено.
3. Введите следующую команду: `mkdir -p /etc/udev/rules.d`.
4. Введите следующую команду:  
   `echo 'SUBSYSTEMS=="usb", ATTRS{manufacturer}=="NVIDIA Corp.", ATTRS{product}=="APX", GROUP="nintendo_switch"' > /etc/udev/rules.d/10-switch.rules`.
5. Введите следующую команду: `udevadm control --reload`.
6. Введите следующую команду: `udevadm trigger`.
7. Выйдите из системы и войдите снова.

Теперь вы должны иметь возможность использовать отправку payload без необходимости использования `sudo`.


&nbsp;

### **Вариант 2: Установка пакета с правилами**

Эти правила позволят _любому_ пользователю получить доступ к вашей консоли через USB, а не только _вашему_ пользователю.

Вы можете просто следовать инструкциям на странице <a href="https://github.com/pheki/nx-udev" target="_blank">nx-udev</a>, или, если вы используете Ubuntu / Debian:

1. Скачайте <a href="https://github.com/pheki/nx-udev/releases/latest/download/nx-udev_latest_all.deb" target="_blank">nx-udev_latest_all.deb</a>.
2. Откройте терминал в том же каталоге, куда вы загрузили файл.
3. Выполните команду `sudo dpkg -i nx-udev_latest_all.deb` для установки пакета.

Теперь вы должны иметь возможность использовать инжектор payload и homebrew с USB-соединением без необходимости использовать `sudo`.

