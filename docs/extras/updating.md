# Обновление системы

Эта страница описывает, как поддерживать вашу систему в актуальном состоянии.

После того как вы выполните наш гайд, ваша система будет состоять из трёх основных элементов, которые можно обновлять: Atmosphère, Hekate и системная прошивка.

### **Обновление Atmosphère**

При обновлении Atmosphère всегда обязательно _читайте примечания к релизу_. В них могут быть указаны важные изменения и модификации вашей системы.

!!! warning "Обновление с версии ниже Atmosphère 1.0.0"
    Если вы обновляете с версии ниже 1.0.0, вам нужно будет выполнить дополнительные шаги. Вам нужно удалить папку `sept` с вашей microSD, удалить файл `fusee-secondary.bin` из папки `atmosphere` и обновить конфигурационный файл Hekate: <a href="../../files/emu/hekate_ipl.ini" download>hekate_ipl.ini</a> в папке `bootloader`.

Когда выходит новая версия Atmosphère, вы можете обновить её, следуя этим шагам:

1. Войдите в RCM и отправьте payload Hekate.
    - Если у вас модифицированная консоль, просто включите её с payload Hekate, переименованным в `payload.bin` в корне вашей microSD карты.
2. Перейдите в `Tools` > `USB Tools` > `SD Card` и подключите Switch к ПК через USB.
3. Скачайте последнюю версию <a href="https://github.com/Atmosphere-NX/Atmosphere/releases" target="_blank">Atmosphère</a> (Скачайте релиз `atmosphere-(версия)-master-(версия)+hbl-(версия)+hbmenu-(версия).zip`).
4. Скопируйте *содержимое* архива Atmosphere `.zip` в корень вашей microSD карты.
    - Если будет предложено перезаписать файлы, согласитесь.
5. Безопасно извлеките устройство `UMS` через операционную систему вашего компьютера.
6. (Если ваша версия Hekate устарела) обновите Hekate, следуя нижеописанным шагам.


### **Обновление Hekate**

При обновлении Hekate всегда обязательно _читайте примечания к релизу_. В них могут быть указаны важные изменения и модификации вашей системы.

Когда выходит новая версия Hekate, вы можете обновить её, следуя этим шагам:

1. Войдите в RCM и отправьте payload Hekate.
    - Если у вас модифицированная консоль, просто включите её с payload Hekate, переименованным в `payload.bin` в корне вашей microSD карты.
2. Перейдите в `Tools` > `USB Tools` > `SD Card` и подключите Switch к ПК через USB.
3. Скачайте последнюю версию <a href="https://github.com/CTCaer/Hekate/releases/" target="_blank">Hekate</a> (Скачайте релиз `hekate_ctcaer_(версия).zip`).
4. Скопируйте папку `bootloader` из архива Hekate `.zip` в корень вашей microSD карты. Если будет предложено перезаписать или объединить файлы, согласитесь с этим.
5. Безопасно извлеките устройство `UMS` через операционную систему вашего компьютера.
6. Вернитесь в главное меню Hekate и нажмите `Reload` > `Reload`, чтобы перезагрузить Hekate с вашей microSD карты.
7. Теперь всё готово, и вы можете загрузиться в CFW.


### **Обновление вашей прошивки**

Всегда проверяйте _перед_ обновлением прошивки системы, поддерживает ли последняя версия Atmosphère _и_ последняя версия Hekate версию прошивки, на которую вы обновляете.

Кроме того, обновление до некоторых версий прошивки или переход через них обновляет прошивку картриджа. Смотрите таблицу ниже для получения информации об этом.


| Обновление с                         | Обновление до                                | Обновляет прошивку картриджа |
| ------------------------------------ | ------------------------------------------- | --------------------------- |
| Ниже 4.0.0                           | Ниже 4.0.0                                  | Нет                         |
| Ниже 4.0.0                           | 4.0.0 или выше                              | Да                          |
| От 4.0.0 до 9.0.0, но ниже 9.0.0     | Как минимум 4.0.1, но ниже 9.0.0            | Нет                         |
| От 4.0.0 до 9.0.0, но ниже 9.0.0     | 9.0.0 или выше                              | Да                          |
| От 9.0.0 до 11.0.0, но ниже 11.0.0   | Как минимум 9.0.1, но ниже 11.0.0           | Нет                         |
| От 9.0.0 до 11.0.0, но ниже 11.0.0   | 11.0.0 или выше                             | Да                          |
| От 11.0.0 до 12.0.0, но ниже 12.0.0  | Как минимум 11.0.1, но ниже 12.0.0          | Нет                         |
| От 11.0.0 до 12.0.0, но ниже 12.0.0  | 12.0.0 или выше                             | Да                          |
| От 12.0.0 до 14.0.0, но ниже 14.0.0  | Как минимум 12.0.1, но ниже 13.2.1          | Нет                         |
| От 12.0.0 до 14.0.0, но ниже 14.0.0  | 14.0.0 или выше                             | Да                          |
| От 14.0.0                            | Последняя поддерживаемая версия Atmosphère и Hekate | Нет                      |


Если хотя бы одна из версий, к которой вы обновляетесь, также обновляет прошивку картриджа, вы не сможете откатиться ниже этой версии, не сделав слот для картриджа непригодным, пока не обновите его.

Atmosphère (и Hekate) поставляются с патчами, которые автоматически отключают слот для картриджа, если обнаружено, что система имеет более старую прошивку картриджа, которая будет обновлена. Если вы запускаете RCM при каждом включении (например, с помощью AutoRCM), это означает, что слот для картриджа не будет обновляться, и вы сможете откатиться ниже этой версии. В этом случае слот для картриджа будет недоступен, пока вы не обновите прошивку.

В противном случае вы можете безопасно обновить прошивку системы через системные настройки.

!!!warning "Заметка об autoRCM"
    Если у вас включен autoRCM и вы обновляете систему на стоковой прошивке, **обновление отключит autoRCM**, и вам придется вручную войти в RCM, чтобы снова загрузить кастомную прошивку.
    Чтобы предотвратить отключение autoRCM, загрузите CFW на sysMMC и обновитесь через настройки оттуда, так как загрузка без AutoRCM <ins>сожжет все сохраненные фьюзы</ins>.

### **О emuMMC**

sysMMC и emuMMC имеют отдельные системные прошивки, и их нужно обновлять отдельно.

Если вы держите ваш emuMMC в оффлайн-режиме, вам нужно будет использовать картридер для обновления прошивки системы, синхронизировать её с другой консолью Nintendo Switch или сбросить обновленную прошивку с вашего sysMMC.

### **Обновление emuMMC путем сброса обновленной прошивки с вашего sysMMC**

!!! warning "У вас есть резервная копия eMMC?"
    Пожалуйста, не начинайте это руководство без выполнения RAW GPP и резервной копии BOOT 0/1 eMMC!

    Вы можете узнать, как сделать это [здесь](../user_guide/all/making_essential_backups.md).

!!! danger "Даунгрейд"
    Это руководство предназначено для обновления вашего emuMMC. Оно **не** для даунгрейда. Даунгрейд, будь то sysMMC или emuMMC, не рекомендуется и не стоит этого делать. Даунгрейд также очень опасен и может привести к серьезным осложнениям, даже если его выполнить правильно.

#### **Что вам нужно:**
- Последняя версия <a href="https://github.com/suchmememanyskill/TegraExplorer/releases" target="_blank">TegraExplorer</a>
- Последняя версия <a href="https://github.com/Atmosphere-NX/Atmosphere/releases" target="_blank">Atmosphere</a>

#### **Подготовка вашей microSD карты**

1. Загрузитесь в Hekate.
2. Перейдите в `Tools` > `USB Tools` > `SD Card` и подключите вашу консоль к ПК через USB.
3. Скачайте последнюю версию `TegraExplorer.bin` и поместите её в `sd:/bootloader/payloads`.

Убедитесь, что ваш sysMMC обновлен перед тем, как перейти к следующему шагу.

#### **Сброс прошивки вашего sysMMC**

1. Убедитесь, что ваш sysMMC обновлен. Если sysMMC не обновлен, загрузитесь в Stock или sysCFW и обновитесь через системные настройки.
    - Рекомендуется использовать sysCFW, так как он сохраняет e-fuses и сохраняет AutoRCM (если применимо).
2. Вставьте `TegraExplorer.bin`, используя ваш любимый инжектор paylaod'ов (Как и с Hekate).
    - Если у вас есть модчип, просто поместите `TegraExplorer.bin` в `sd:/bootloader/payloads` на вашей microSD карте, затем включите консоль и загрузите TegraExplorer через меню payload'ов Hekate (`Payloads` > `TegraExplorer.bin`).
3. Используя джойстик и кнопки A, выберите `FirmwareDump.te`, затем выберите `Dump sysmmc`.
    - Если навигация не работает с вашим Joycon, можно использовать кнопки громкости для навигации и кнопку питания для выбора. (Это также требуется для пользователей Switch Lite.)
4. Подождите 1-2 минуты, пока скрипт сбросит прошивку.
5. Когда скрипт завершит выполнение, нажмите любую кнопку.
6. Выберите `Reboot to bootloader/update.bin`.

#### **Обновление вашего emuMMC с Daybreak**

1. В Hekate перейдите в `Launch -> Atmosphere`.
2. После загрузки удерживайте `R`, запуская игру, чтобы попасть в меню homebrew.
3. Найдите Daybreak в меню homebrew и запустите его.
4. Нажмите `Install` и перейдите в `sd:/tegraexplorer/Firmware/<latest firmware number>`.
5. Нажмите `Continue`, а затем `Preserve settings`.
    - Если вы видите сообщение `Warning: exFAT firmware is missing or corrupt`, вероятно, у вас не установлены драйверы exFAT на вашем sysMMC. Просто нажмите продолжить, если это так.
6. Если доступно, выберите `Install (FAT32 + exFAT)`, в противном случае выберите `Install (FAT32)` и затем `Continue`.
7. Подождите, пока Daybreak завершит установку сброшенной прошивки.
8. Когда установка завершится, вам предложат перезагрузить систему. Нажмите `Reboot`.
9. После перезагрузки загрузитесь в emuMMC и убедитесь, что система работает. Вы можете проверить обновление системы в `Настройки -> Система`.

